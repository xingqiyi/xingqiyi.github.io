<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Language" Content="en" />
    <style>
        body {
            font-size: 1.5em;
        }
        
        #myCanvas {
            border: solid 2px red;
        }
    </style>

</head>

<body>

    <h3>canvas:</h3>
    <button id='clean'>clean</button>
    <canvas id='myCanvas'></canvas>

    <script>
        var canvas = document.getElementById('myCanvas');
        canvas.width = 500;
        canvas.height = 500;
        var ctx = canvas.getContext('2d');

        function drawLine(start, end) {
            ctx.beginPath();

            ctx.lineWidth = 3;
            ctx.lineJoin = "round";

            ctx.moveTo(start.x, start.y);
            ctx.lineTo(end.x, end.y);
            ctx.stroke();
        }


        var firstPos = {};
        var lastPos = {};
        var mouseStatus = 'up'

        canvas.addEventListener('mousemove', function(event) {
            // console.log(event.x, event.y);
            var mousePos = getMousePos(canvas, event);
            if (mouseStatus == 'down') {
                drawLine(lastPos, mousePos);
                drawTriangle(lastPos, mousePos, firstPos);
            }
            lastPos.x = mousePos.x;
            lastPos.y = mousePos.y;
        })

        canvas.addEventListener('mousedown', function(event) {
            mouseStatus = 'down';
            var mousePos = getMousePos(canvas, event);

            firstPos.x = mousePos.x;
            firstPos.y = mousePos.y;

            lastPos.x = mousePos.x;
            lastPos.y = mousePos.y;


        });

        canvas.addEventListener('mouseup', function(event) {
            mouseStatus = 'up';
        });


        function getMousePos(canvas, event) {
            var rect = canvas.getBoundingClientRect();
            return {
                x: event.clientX - rect.left,
                y: event.clientY - rect.top
            };
        }

        document.getElementById('clean').addEventListener('click', function(event) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        });



        function drawTriangle(point1, point2, point3) {
            ctx.beginPath();


            ctx.fillStyle = "#58a";

            ctx.shadowColor = "#58a";


            ctx.moveTo(point1.x, point1.y);

            ctx.lineTo(point2.x, point2.y);
            ctx.lineTo(point3.x, point3.y);
            ctx.lineTo(point1.x, point1.y);


            ctx.fill();
        }


        // var a = [{
        //     x: 100,
        //     y: 100
        // }, {
        //     x: 200,
        //     y: 200
        // }, {
        //     x: 10,
        //     y: 200
        // }];
        // drawTriangle(a[0], a[1], a[2]);
    </script>

</body>

</html>